contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.kknn',
ps = list(k = list(1, 15))
))
lll = new('KNN')
lll
ps = ps(
laplace = p_dbl(lower = l[[1]], upper = l[[2]]))
ps = ps(
laplace = p_dbl(lower = 0, upper = 1))
class(ps)
setClass('KNN',
contains = 'model',
slots = c(
ps = 'ParamSet'),
prototype = list(
l = 'classif.kknn',
ps = ps(
k = p_int(lower = 0, upper = 1)
))
))
setClass('KNN',
contains = 'model',
slots = c(
ps = 'ParamSet'),
prototype = list(
l = 'classif.kknn',
ps = ps(k = p_int(lower = 0, upper = 1))
))
setClass('KNN',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.kknn',
ps = list(k = list(lower = 0, upper = 1))
))
xx = new('KNN')
xx
xx@ps[[1]]
xx@ps$k[[1]]
setClass('GLMNET',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.glmnet',
ps = list(alpha = list(lower = 0, upper = 1),
s     = list(lower = 0, upper = 1))
))
setClass('KNN',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.kknn',
ps = list(k = list(lower = 0, upper = 1))
))
# Defining learners
k = new('KNN')
g = new('glmnet')
g = new('GLMNET')
g
setGeneric('setHyperparameters', function(learner, inner) standardGeneric('setHyperparameters'))
setMethod('setHyperparameters',
signature('model'),
function(model, inner){
name = model@l
learner = lrn(name)
if (name == 'classif.kknn'){
ps = ps(
k = p_int(lower = model@ps$k[[1]], upper =model@ps$k[[2]]))
} else if (name == 'classif.glmnet'){
ps = ps(
alpha = p_dbl(lower = model@ps$alpha[[1]], upper =model@ps$alpha[[1]]),
s = p_dbl(lower = model@ps$s[[1]], upper = model@ps$s[[1]]))
}
cv.inner = rsmp(inner@resampling)
measure = msr(inner@measure)
terminator = trm(inner@terminator[[1]], n_evals = inner@terminator[[2]])
tuner = tnr(inner@tuner[[1]], resolution = inner@tuner[[2]])
at = AutoTuner$new(learner, cv.inner, measure, terminator, tuner, ps)
})
setGeneric('setHyperparameters', function(model, inner) standardGeneric('setHyperparameters'))
setMethod('setHyperparameters',
signature('model'),
function(model, inner){
name = model@l
learner = lrn(name)
if (name == 'classif.kknn'){
ps = ps(
k = p_int(lower = model@ps$k[[1]], upper =model@ps$k[[2]]))
} else if (name == 'classif.glmnet'){
ps = ps(
alpha = p_dbl(lower = model@ps$alpha[[1]], upper =model@ps$alpha[[1]]),
s = p_dbl(lower = model@ps$s[[1]], upper = model@ps$s[[1]]))
}
cv.inner = rsmp(inner@resampling)
measure = msr(inner@measure)
terminator = trm(inner@terminator[[1]], n_evals = inner@terminator[[2]])
tuner = tnr(inner@tuner[[1]], resolution = inner@tuner[[2]])
at = AutoTuner$new(learner, cv.inner, measure, terminator, tuner, ps)
})
# Defining learners
k = setHyperparameters(new('KNN'), inner)
# Defining learners
k = setHyperparameters(new('KNN'), cv.inner)
# Defining learners
k = setHyperparameters(new('KNN'), cv.in)
k
g = setHyperparameters(new('GLMNET', cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
class(pseqMLR)
class(bmr)
source('~/git/pseqML/R/AllClasses.r')
source('~/git/pseqML/R/AllClasses.r')
library(pseqML)
require(pseqML)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN'), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(k, g))
library(pseqML)
require(pseqML)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN'), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(k, g))
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(g))
bmr
bmr$aggregate(msrs(c('classif.ce', 'classif.acc', 'time_train')))
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(k))
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(k))
bmr$aggregate(msrs(c('classif.ce', 'classif.acc', 'time_train')))
require(mlr3)
as.data.table(mlr_resamplings)
r = rsmp('cv', folds = 3)
r
r = rsmp('repeated_cv', repeats = 5, folds = 3)
r
setMethod('check',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
})
setGeneric('check', function(object) standardGeneric('check'))
setMethod('check',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
})
setClass('outer',
slots = c(
resampling = 'character',
repeats = 'numeric',
ratio = 'numeric',
folds = 'numeric'
),
prototype = list(
resampling = 'cv',
repeats = NULL,
ratio = NULL,
folds = 5,
))
setClass('outer',
slots = c(
resampling = 'character',
repeats = 'numeric',
ratio = 'numeric',
folds = 'numeric'
),
prototype = list(
resampling = 'cv',
repeats = NULL,
ratio = NULL,
folds = 5
))
setGeneric('check', function(object) standardGeneric('check'))
setMethod('check',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
})
o = new('outer')
o
o = new('outer', resampling = 'bootstrap', repeats = 2, ratio = 0.6)
o
setGeneric('check', function(object) standardGeneric('check'))
setMethod('check',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
return(outer)
})
setGeneric('init_outer', function(object) standardGeneric('check'))
setMethod('init_outer',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
return(outer)
})
setGeneric('init_outer', function(object) standardGeneric('init_outer'))
setMethod('init_outer',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio, folds = NULL)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = NULL)
}
return(outer)
})
init_outer(new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10))
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
new('outer')
setClass('outer',
slots = c(
resampling = 'character',
repeats = 'numeric',
ratio = 'numeric',
folds = 'numeric'
),
prototype = list(
resampling = 'cv',
repeats = 0,
ratio = 0,
folds = 5
))
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
outer
outer = init_outer(outer)
setGeneric('init_outer', function(object) standardGeneric('init_outer'))
setMethod('init_outer',
signature('outer'),
function(object){
strategies = c('bootstrap', 'cv', 'holdout', 'loo', 'repeated_cv')
stopifnot(object@resampling %in% strategies)
if (object@resampling == 'bootstrap'){
outer = rsmp(object@resampling, repeats = object@repeats, ratio = object@ratio)
} else if (object@resampling == 'cv'){
outer = rsmp(object@resampling, folds = object@folds)
} else if (object@resampling == 'holdout'){
outer = rsmp(object@resampling, ratio = object@ratio)
} else if (object@resampling == 'loo'){
outer = rsmp(object@resampling)
} else if (object@resampling == 'repeated_cv'){
outer = rsmp(object@resampling, repeats = object@repeats, folds = object@folds)
}
return(outer)
})
outer = init_outer(outer)
outer
library(pseqML)
source('~/.active-rstudio-document', echo=TRUE)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
require(mlr3learners)
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
require(mlr3verse)
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
n = setHyperparameters(new('NB'), cv.in)
l = list(k, g, n)
# Set outer resampling
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
outer = init_outer(outer)
library(pseqML)
install.packages('Rtools')
install.packages('Rtools40')
writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
Sys.which("make")
library(pseqML)
source('~/.active-rstudio-document', echo=TRUE)
require(pseqML)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
require(pseqML)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
n = setHyperparameters(new('NB'), cv.in)
l = list(k, g, n)
# Set outer resampling
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
outer = init_outer(outer)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = l,
outer = outer)
bmr$aggregate(msrs(c('classif.ce', 'classif.acc', 'time_train')))
require(pseqML)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
require(mlr3)
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
usethis::use_package('mlr3')
usethis::use_package('phyloseq')
usethis::use_package('mlr3learner')
require(mlr3learners)
usethis::use_package('mlr3learners')
usethis::use_package('mlr3verse')
library(pseqML)
source('~/.active-rstudio-document', echo=TRUE)
require(mlr3verse)
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
setOldClass('phyloseq')
class(pseq)
library(pseqML)
require(pseqML)
search()
require(roxygen2)
library(pseqML)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
learner = lrn('classif.svm')
learner$param_set
learner = lrn('classif.ksvm')
learner$param_set
learner = lrn('classif.xgboost')
learner$param_set
learner = lrn('classif.randomForest')
learner$param_set
source('~/git/pseqML/R/AllClasses.r')
setClass('XGBOOST',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.xgboost',
ps = list(nrounds = list(lower = 100, upper = 500),
max_depth = list(lower = 1, upper = 10,
eta = list(lower = .1, upper = .5),
lambda = list(lower = -1, upper = 0, trafo = function(x) 10^x))
))
)
setClass('XGBOOST',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.xgboost',
ps = list(nrounds = list(lower = 100, upper = 500),
max_depth = list(lower = 1, upper = 10,
eta = list(lower = .1, upper = .5),
lambda = list(lower = -1, upper = 0, trafo = function(x) 10^x))
)))
setClass('RF',
contains = 'model',
slots = c(
ps = 'list'),
prototype = list(
l = 'classif.randomForest',
ps = list(ntree = list(lower = 500, upper = 1000),
mtry = list(lower = 5, upper = 10),
nodesize = list(lower = 1, upper = 5))
))
library(pseqML)
# Load phyloseq data
pseq = readRDS('~/projects/Metagenomics/data/phyloseq_probeCase.rds')
# Convert phyloseq to pseqML
pseqML = new('pseqML', data = pseq, target = 'cancer')
# Convert pseqML to MLR task
pseqMLR = pseq2mlr(pseqML, id = 'example')
# Defining cv inner
cv.in = new('inner')
# Defining learners
k = setHyperparameters(new('KNN', ps = list(k = list(1, 15))), cv.in)
g = setHyperparameters(new('GLMNET'), cv.in)
n = setHyperparameters(new('NB'), cv.in)
l = list(k, g, n)
# Set outer resampling
outer = new('outer', resampling = 'repeated_cv', repeats = 5, folds = 10)
outer = init_outer(outer)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = l,
outer = outer)
# Set outer resampling
outer = new('outer', resampling = 'repeated_cv', repeats = 2, folds = 3)
outer = init_outer(outer)
bmr = pseqML::benchML(tasks = list(pseqMLR),
learners = list(g, n),
outer = outer)
class(bmr)
